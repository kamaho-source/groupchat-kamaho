services:
  groupchat-kamaho-app:
    container_name: groupchat-kamaho-app
    build:
      context: .
      dockerfile: ./docker/backend.Dockerfile
    ports:
      - "8000:80"
    volumes:
      - ./backend:/var/www/html
      - ./docker/apache/000-default.conf:/etc/apache2/sites-available/000-default.conf
    environment:
      TZ: "Asia/Tokyo"

  groupchat-kamaho-frontend:
    container_name: groupchat-kamaho-frontend
    build:
      context: .
      dockerfile: ./docker/frontend.Dockerfile
    ports:
      - "3000:3000"
    volumes:
      - ./frontend:/app/
      - /app/node_modules


    working_dir: /app
    command: npm run dev
    environment:
      TZ: "Asia/Tokyo"
      NODE_ENV: development


    depends_on:
      - groupchat-kamaho-app

  groupchat-kamaho-mysql:
    container_name: groupchat-kamaho-mysql
    build:
      context: .
      dockerfile: ./docker/database.Dockerfile
    ports:
        - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: kamaho
      MYSQL_USER: kamaho
      MYSQL_PASSWORD: kamaho
      TZ: "Asia/Tokyo"

    volumes:
      - ./docker/mysql:/var/lib/mysql
      - ./database/log:/var/log/database

    platform: linux/amd64





